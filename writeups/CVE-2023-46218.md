# ⚠️ Curl `Curl_socketpair()` Fallback Vulnerability – Potential MITM Risk:
Link of the report: [https://hackerone.com/reports/3148937].
## Summary:
A man-in-the-middle vulnerability was discovered in Curl’s internal function `Curl_socketpair()`, which is used as a fallback 
when the native `socketpair()` function is unavailable.
Because of a race condition between the time the listening socket is opened and the client socket connects,
an attacker could potentially intercept the connection and bypass the basic verification.

## Vulnerabilities:
- Curl tried to verify the connection by comparing a randomly generated 9-byte secret string between the two sockets.
- However, due to a slight connection gap, an attacker on the same host could guess the secret and connect first, hijacking the session.
- While the chances are low, it's not impossible.
## fixes:
They suggested to instead of generating a random 9 bytes number to compare, comparing the TCP ports of both the sockets since they are on the same localhost interface
## Lesson learned:
Security shouldn't rely on randomness alone — especially if an attacker has local access
